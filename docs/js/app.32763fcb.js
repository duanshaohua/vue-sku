(function(e){function t(t){for(var i,c,u=t[0],o=t[1],s=t[2],f=0,d=[];f<u.length;f++)c=u[f],a[c]&&d.push(a[c][0]),a[c]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);l&&l(t);while(d.length)d.shift()();return r.push.apply(r,s||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,u=1;u<n.length;u++){var o=n[u];0!==a[o]&&(i=!1)}i&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},a={app:0},r=[];function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],o=u.push.bind(u);u.push=t,u=u.slice();for(var s=0;s<u.length;s++)t(u[s]);var l=o;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"2c40":function(e,t,n){},"2d3f":function(e,t,n){"use strict";var i=n("832b"),a=n.n(i);a.a},5604:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"sku_container"},[n("sku-editer",{model:{value:e.specification,callback:function(t){e.specification=t},expression:"specification"}})],1),n("div",{staticClass:"sku_container"},[n("sku-select",{attrs:{skusData:e.specificationFilter}})],1),n("div",{staticClass:"sku_container"},[n("sku-table",{attrs:{skusData:e.specificationFilter},model:{value:e.sku,callback:function(t){e.sku=t},expression:"sku"}})],1),n("div",{staticClass:"sku_container"},[n("vue-json-pretty",{attrs:{data:e.specificationFilter}})],1)])},r=[],c=n("d538"),u=n.n(c),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sku-editer"},[e._l(e.specification,function(t,i){return n("div",{key:t.id,staticClass:"sku_group mb10"},[n("div",{staticClass:"spec_title"},[n("span",{staticClass:"label"},[e._v("规格名：")]),n("el-input",{staticClass:"input",attrs:{placeholder:"请输入规格名"},model:{value:t.value,callback:function(n){e.$set(t,"value","string"===typeof n?n.trim():n)},expression:"spec.value"}}),n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",plain:"",circle:""},on:{click:function(t){return e.delSepc(i)}}})],1),n("div",{staticClass:"group_container"},[n("span",{staticClass:"label"},[e._v("规格值：")]),e._l(t.leaf,function(t,a){return n("el-popover",{key:a,attrs:{placement:"bottom",width:"120",trigger:"click"}},[n("el-input",{staticStyle:{width:"100%"},model:{value:t.value,callback:function(n){e.$set(t,"value","string"===typeof n?n.trim():n)},expression:"option.value"}}),n("div",{staticClass:"sku_item",attrs:{slot:"reference"},slot:"reference"},[n("span",{staticClass:"remove el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.delOption(i,a)}}}),n("div",{staticClass:"text"},[e._v(e._s(t.value))])])],1)}),n("el-input",{staticClass:"input",attrs:{"suffix-icon":"el-icon-plus",placeholder:"多个值以空格隔开"},on:{blur:function(t){return e.addOption(i)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addOption(i)}},model:{value:e.addValues[i],callback:function(t){e.$set(e.addValues,i,t)},expression:"addValues[index]"}})],2)])}),n("div",{staticClass:"spec_title"},[n("el-button",{attrs:{type:"primary",disabled:e.disabled,plain:""},on:{click:e.addSpec}},[e._v("添加规格项目")])],1)],2)},s=[],l=n("75fc");n("28a5"),n("6762"),n("2fdb"),n("ac6a"),n("4f7f"),n("5df3"),n("1c4c"),n("6b54");function f(){var e=+new Date+"",t=parseInt(65536*(1+Math.random()))+"";return(+(t+e)).toString(32)}function d(e){return Array.from(new Set(e))}function p(e,t){return e=d(e),t=d(t),e.concat(t).filter(function(n){return!(e.includes(n)&&t.includes(n))})}var v={model:{prop:"value",event:"change"},props:{value:{type:Array,default:function(){return[{id:1,value:"颜色",leaf:[{id:11,value:"白色"},{id:12,value:"黑色"},{id:13,value:"金色"}]},{id:2,value:"内存",leaf:[{id:21,value:"128G"},{id:22,value:"256G"},{id:23,value:"512G"}]}]}}},data:function(){return{addValues:[],specification:[{id:1,value:"颜色",leaf:[{id:11,value:"白色"},{id:12,value:"黑色"},{id:13,value:"金色"}]},{id:2,value:"内存",leaf:[{id:21,value:"128G"},{id:22,value:"256G"},{id:23,value:"512G"}]}]}},computed:{disabled:function(){return this.specification.length>3||this.specification.some(function(e){return!e.value})}},watch:{value:{handler:function(e){this.specification=e},deep:!0},specification:{handler:function(e){this.$emit("change",e)},deep:!0}},mouted:function(){this.specification=this.value},methods:{addSpec:function(){this.specification.push({id:f()+"_id",value:"",leaf:[]})},delSepc:function(e){this.specification.splice(e,1)},addOption:function(e){var t=this.addValues[e]||"";if(t=t.trim(),t){var n=this.specification[e].leaf,i=t.split(/\s+/).filter(function(e){return!n.some(function(t){return t.value===e})}).map(function(e){return{id:f()+"_id",value:e}});this.specification[e].leaf=d([].concat(Object(l["a"])(n),Object(l["a"])(i))),this.$set(this.addValues,e,"")}},delOption:function(e,t){this.specification[e].leaf.splice(t,1)}}},h=v,m=(n("d052"),n("2877")),b=Object(m["a"])(h,o,s,!1,null,"f608ad2a",null),k=b.exports,_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e._l(e.skusData,function(t,i){return n("div",{key:t.id+"_id",staticClass:"spec_title"},[n("span",{staticClass:"label"},[e._v(e._s(t.value))]),e._l(t.leaf,function(t){return n("el-button",{key:t.id,attrs:{type:e.activeSku[i].option.id===t.id?"primary":""},on:{click:function(n){return e.selectSku(i,t)}}},[e._v(e._s(t.value))])})],2)}),e._l(e.activeSku,function(t,i){return n("div",{key:i,staticClass:"spec_title"},[e._v(e._s(t.spec.value)+"："+e._s(t.option.value))])})],2)},g=[],y={data:function(){return{activeSku:[]}},props:{skusData:{type:Array,default:function(){return[]}}},watch:{skusData:{deep:!0,immediate:!0,handler:function(e){this.activeSku=e.map(function(e){return{spec:{value:e.value,id:e.id},option:{}}})}}},methods:{selectSku:function(e,t){if(this.activeSku[e].option&&this.activeSku[e].option.id===t.id)return this.activeSku[e].option={};this.activeSku[e].option=t}}},w=y,O=(n("894d"),Object(m["a"])(w,_,g,!1,null,"179840fc",null)),x=O.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"flex"},[n("el-form",{staticClass:"guide_coefficient",attrs:{inline:!0,model:e.coefficient}},[n("el-form-item",{attrs:{label:"指导价倍数",prop:"guide_coefficient"}},[n("el-input-number",{attrs:{step:.1,min:1,precision:2},model:{value:e.coefficient.guide_coefficient,callback:function(t){e.$set(e.coefficient,"guide_coefficient",t)},expression:"coefficient.guide_coefficient"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.setGuideCoefficient}},[e._v("批量设置指导价倍数")])],1)],1),n("el-form",{attrs:{inline:!0,model:e.coefficient}},[n("el-form-item",{attrs:{label:"标价倍数",prop:"purchase_coefficient"}},[n("el-input-number",{attrs:{step:.1,min:1,precision:2},model:{value:e.coefficient.purchase_coefficient,callback:function(t){e.$set(e.coefficient,"purchase_coefficient",t)},expression:"coefficient.purchase_coefficient"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.setPurchaseCoefficient}},[e._v("批量设置标价倍数")])],1)],1)],1),n("egrid",e._g(e._b({attrs:{border:"","max-height":"500",data:e.data,columns:e.columns,"columns-props":e.columnsProps,"highlight-current-row":""}},"egrid",e.$attrs,!1),e.$listeners))],1)},j=[],P=(n("7f7f"),n("cebc")),S=(n("7514"),n("f05a")),$=n.n(S),D=n("a8db");function E(e){for(var t=[],n=e.length-1;n>=0;n--)e[n+1]&&e[n+1].leaf?t[n]=e[n+1].leaf.length*t[n+1]||1:t[n]=1;return t}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=n||{},a=i.optionValue,r=void 0===a?"id":a,c=i.optionText,u=void 0===c?"value":c,o=[],s=0,l={},f=E(e);if(0===e.length)return o;e.forEach(function(e){var t=e.leaf;if(!t||0===t.length)return!0;s=(s||1)*t.length}),t.forEach(function(e){var t=e.skus,n=Object(D["a"])(e,["skus"]);l[t.map(function(e){return"".concat(e.k_id,"_").concat(e.v_id)}).join("|")]=n});for(var d=function(t){var n=[],i=[];e.forEach(function(a,c){var o=a.leaf,s={};if(!o||0===o.length)return!0;if(o.length>1){var l=parseInt(t/f[c],10)%o.length;s=e[c].leaf[l]}else s=e[c].leaf[0];a[r]&&s[r]&&(i.push("".concat(a[r],"_").concat(s[r])),n.push({k_id:a[r],k:a[u],v_id:s[r],v:s[u]}))});var a=l[i.join("|")]||{},c=Object.assign({},a);o.push(Object(P["a"])({},c,{skus:n}))},p=0;p<s;p++)d(p);return o}var V={components:{Egrid:$.a},model:{prop:"value",event:"change"},props:{value:{type:Array,default:function(){return[]}},skusData:{type:Array,default:function(){return[]}}},computed:{skusList:function(){return G(this.skusData).map(function(e){return{skus:e.skus,ids:e.skus.reduce(function(t,n,i){return"".concat(t).concat(n.k_id,"-").concat(n.v_id).concat(i===e.skus.length-1?"":"_")},"")}})},columns:function(){var e=this.skusData.map(function(e){return{label:e.value,fixed:!0,width:100,formater:function(t){var n=t.skus.find(function(t){return t.k===e.value});return n.v}}});return[].concat(Object(l["a"])(e),Object(l["a"])(this.customColumns))}},watch:{skusList:{deep:!0,immediate:!0,handler:function(e,t){var n=this;if(!e.length)return this.data=[];if(!t||!t.length)return this.initData(e);if(e.length===t.length)return this.data=e.map(function(e,t){return Object(P["a"])({},n.data[t],e)});if(e[0].skus.length!==t[0].skus.length)return this.initData(e);var i=this.diffIds(e,t);if(e.length>t.length){var a=[];e.forEach(function(e){var t=n.data.find(function(t){return t.ids===e.ids});t?a.push(t):a.push(Object(P["a"])({},e,n.fields))}),this.data=a}else this.data=this.data.filter(function(e){return!i.includes(e.ids)})}},data:{deep:!0,immediate:!0,handler:function(e){this.$emit("change",e)}}},data:function(){return{data:[],columnsProps:{align:"center",minWidth:100},coefficient:{purchase_coefficient:0,guide_coefficient:0},fields:{name:"",code:"",barcode:"",purchasePrice:0,guidePrice:0,sellingPrice:0,deliveryPrice:0},customColumns:[{label:"规格名称",width:230,component:i["default"].extend({props:["row"],render:function(e){var t=this;return e("el-input",{attrs:{placeholder:"规格名称",value:t.row.name},on:{input:function(e){return t.row.name=e.trim()}}})}})},{label:"规格编码",width:230,component:i["default"].extend({props:["row"],render:function(e){var t=this;return e("el-input",{attrs:{placeholder:"规格编码",value:t.row.code},on:{input:function(e){return t.row.code=e.trim()}}})}})},{label:"建议进价",width:230,component:i["default"].extend({props:["row"],render:function(e){var t=this;return e("el-input-number",{props:{value:t.row.purchasePrice,step:.01,min:0,controls:!1,precision:2},on:{input:function(e){return t.row.purchasePrice=e}}})}})},{label:"厂家指导价",width:230,component:i["default"].extend({props:["row"],render:function(e){var t=this;return e("el-input-number",{props:{value:t.row.guidePrice,step:.01,min:0,controls:!1,precision:2},on:{input:function(e){return t.row.guidePrice=e}}})}})},{label:"建议售价",width:230,component:i["default"].extend({props:["row"],render:function(e){var t=this;return e("el-input-number",{props:{value:t.row.sellingPrice,step:.01,min:0,controls:!1,precision:2},on:{input:function(e){return t.row.sellingPrice=e}}})}})},{label:"建议配送价",width:230,component:i["default"].extend({props:["row"],render:function(e){var t=this;return e("el-input-number",{props:{value:t.row.deliveryPrice,step:.01,min:0,controls:!1,precision:2},on:{input:function(e){return t.row.deliveryPrice=e}}})}})}]}},methods:{diffIds:function(e,t){return e=e.map(function(e){return e.ids}),t=t.map(function(e){return e.ids}),p(e,t)},initData:function(e){var t=this;this.data=e.map(function(e){return t.fields.name=t.skuName(e.skus),Object(P["a"])({},e,t.fields)})},skuName:function(e){return e.map(function(e){return e.v}).join("")},setGuideCoefficient:function(){var e=this.coefficient.guide_coefficient;this.data=this.data.map(function(t){return Object(P["a"])({},t,{purchasePrice:(t.guidePrice||0)*e})})},setPurchaseCoefficient:function(){var e=this.coefficient.purchase_coefficient;this.data=this.data.map(function(t){return Object(P["a"])({},t,{sellingPrice:(t.purchasePrice||0)*e})})}}},A=V,M=(n("84ca"),Object(m["a"])(A,C,j,!1,null,"40a1bce2",null)),T=M.exports,F={components:{VueJsonPretty:u.a,SkuEditer:k,SkuSelect:x,SkuTable:T},data:function(){return{specification:[],sku:[]}},computed:{specificationFilter:function(){return this.specification.filter(function(e){return e.value&&e.leaf.length})}}},I=F,J=(n("2d3f"),Object(m["a"])(I,a,r,!1,null,"af8b46e2",null)),z=J.exports,L=n("5c96"),N=n.n(L);n("0fae");i["default"].use(N.a,{size:"small"}),i["default"].use($.a),i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(z)}}).$mount("#app")},"832b":function(e,t,n){},"84ca":function(e,t,n){"use strict";var i=n("2c40"),a=n.n(i);a.a},8794:function(e,t,n){},"894d":function(e,t,n){"use strict";var i=n("8794"),a=n.n(i);a.a},d052:function(e,t,n){"use strict";var i=n("5604"),a=n.n(i);a.a}});
//# sourceMappingURL=app.32763fcb.js.map